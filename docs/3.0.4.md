
# Percona build of ProxySQL 3.0.4 and ProxySQL admin tools (2026-02-17)

--8<--- "rn-block-top.md"

## Release highlights

This release introduces Percona's build of ProxySQL 3.0.4, incorporating the latest upstream features and improvements. Instead of releasing a Percona build of ProxySQL 3.0.2 and 3.0.3, we are skipping to 3.0.4. This build includes all enhancements and bug fixes from [ProxySQL 3.0.2], [ProxySQL 3.0.3], and [ProxySQL 3.0.4].

From [v3.0.2][ProxySQL 3.0.2]

* Introduced support for MySQL Group Replication (for MySQL 8.4 and 9.x), widening ProxySQL's high-availability and clustering compatibility.

* Fixed a memory leak in the global MySQL statistics subsystem (stats_mysql_global), improving stability over long uptimes.

* Prevented an integer-overflow condition in the SQLite3_memory_bytes field from stats_mysql_global, enhancing robustness of memory/statistics tracking.

* Corrected handling of binary logging for prepared statements that have zero parameters â€” ensuring proper log behavior even for empty-parameter statements.

From [v3.0.3][ProxySQL 3.0.3]

* Resolved a "use-after-free" / memory-safety bug triggered by SHOW PROCESSLIST under MySQL mode, preventing potential crashes or corruption during session-inspection commands.

* Fixed a "heap-after-use" issue involving internal sessions and SHOW PROCESSLIST, further strengthening memory safety and stability in monitoring/administrative use cases.

From [v3.0.4][ProxySQL 3.0.4]

* Improved MySQL protocol robustness with special handling for unexpected COM_PING packets, preventing potential connection issues and improving overall protocol stability.

* Fixed incorrect behavior of the `cache_empty_result` field in query rules when set to "0". Previously, it prevented caching of any resultsets regardless of row count. Now, it correctly caches non-empty resultsets while skipping empty resultsets, aligning with the documented behavior and improving cache efficiency.

* Corrected affected rows reporting for DDL queries in the ProxySQL Admin interface. DDL queries now correctly return 0 affected rows instead of showing the previous DML's count, providing accurate metadata to administrative tools and scripts.

* Fixed artificially high ping latency in MySQL backend monitoring caused by inefficient task dispatching. The fix introduces batching (batches of 30) with poll() calls between batches and reduces the monitor ping poll() timeout from 100ms to 10ms, providing more responsive monitoring with accurate latency measurements.

* Fixed a critical SQL injection vulnerability in configuration parsing by replacing sprintf-based SQL query construction with prepared statements using bound parameters. The fix also handles automatic prefix stripping for mysql_variables, pgsql_variables, and admin_variables config parsing, preventing SQL injection attacks when users mistakenly include module prefixes (e.g., "mysql-") in variable names.

* Refactored prepared statement cache design with a lock-free hot path for prepared statement cache operations, reducing contention in high-concurrency MySQL environments. The redesign optimizes transaction command parsing to avoid unnecessary tokenization and replaces `std::string` with `char[]` to eliminate heap allocation in hot paths, significantly improving performance for high-concurrency workloads.

* Improved fast forward replication validation for MySQL 8.0+ clients with enhanced `CLIENT_DEPRECATE_EOF` capability flag handling, preventing protocol mismatches and connection issues in MySQL replication scenarios.

* Refactored GTID reconnect logic to prevent `events_count` from being reset during reconnection attempts, preserving MySQL replication state and reducing unnecessary replication restarts, improving replication stability during network interruptions.

## No changes

The [ProxySQL Admin] tool and the [pxc_scheduler_handler] tool within Percona's Build of ProxySQL 3.0.4 have not been updated and are the same as in the previous Percona release.

## Additional resources
--8<--- "rn-ar.md"

[ProxySQL 3.0.2]: https://github.com/sysown/proxysql/releases/tag/v3.0.2
[ProxySQL 3.0.3]: https://github.com/sysown/proxysql/releases/tag/v3.0.3
[ProxySQL 3.0.4]: https://github.com/sysown/proxysql/releases/tag/v3.0.4